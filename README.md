# Автоматизированная система контроля уровня знаний (АСКУЗ)
## Оглавление
1. [Используемые технологии и компоненты](#Используемые-технологии-и-компоненты)
2. [Описание](#Описание)
3. [Установка](#Установка)
3. [Описание базы данных](#Описание-базы-данных)
4. [Управление системой тестирования](#Управление-системой-тестированияа)
5. [Проблемные вопросы](#Проблемные-вопросы)
6. [Состав дистрибутива](#Состав-дистрибутива)
## Используемые технологии и компоненты
### - Система тестирования: WEB-сервер Apache, базы данных (MySQL для Windows, MariaDB для Linux), PHP, JavaScript;
### - Система управления и анализа:
#### 1. PHP:
- [Adminer](https://www.adminer.org/) - инструмент администрирования MySQL  в виде одиночного php-файла.
- [PHP-библиотека FastJSON JSON-кодировщика/декодировщика](http://pear.php.net/pepr/pepr-proposal-show.php?id=198)

Copyright (c) 2006 - 2007 Andrea Giammarchi.
#### 2. JavaScript
 - Библиотека JQuery с использованием Ajax-запросов.
 - [D3.js для построения диаграм](https://d3js.org/).
### 3. Python: для создания в БД таблицы тестов из файла Excel.
### 4. Протестировано в среде:
- Windows 7 x64 Ultimate,
- Laragon Full 4.0.16 190914,
- php-7.2.19-Win32-VC15-x64,
- Apache httpd-2.4.35-win64VC15,
- MySQL mysql-5.7.24-winx64 
____
[:arrow_up:Оглавление](#Оглавление)
____
## Описание
### Возможности системы
- сетевое тестирование в WEB-браузере для тестов, включенных преподавателем;
- тестирование только зарегистированных пользователей с помощью заданий закрытого типа с единственным выбором из 3, 4 или 5 возможных вариантов ответов;
- пользователям недоступна самостоятельная регистрация;
- повторная сдача пройденного теста невозможна, без удаления сведений о прохождении теста преподавателем;
- защита от параллельной сдачи на основе сессий и БД;
- запись ошибок (неправильный пароль, попытка параллельной сдачи) в лог-файл с возможностью просмотра через WEB-браузер;
- ограничение по времени теста с выводом в браузер оставщегося времени и количества вопросов;
- просмотр результатов тестирования и вопросов, на которые были даны неправильные ответы;
- установка уровня сложности для каждого вопроса;
- тренировочный режим тестирования с выводом всех вопросов, без записываия результатов в базу данных;
- просмотр результатов тестирования с выводом статистики для выбранного теста и выбранной группы.
### Пример работы теста:
![Пример работы](/_jpg/12.jpg)
![Пример работы](/_jpg/13.jpg)
![Пример работы](/_jpg/14.jpg)
![Пример работы](/_jpg/15.jpg)
![Пример работы](/_jpg/18.jpg)

### Пример работы системы управления:
![Пример работы](/_jpg/10.jpg)
![Пример работы](/_jpg/11.jpg)
![Пример работы](/_jpg/19.jpg)
![Пример работы](/_jpg/20.jpg)
![Пример работы](/_jpg/21.jpg)
![Пример работы](/_jpg/22.jpg)
____
[:arrow_up:Оглавление](#Оглавление)
____


## Установка
1. Скопировать папки "test" и "test_logs" на WEB-сервер и установить права NTFS:
	"только чтение" на папку "test" и "чтение и запись" на папку "test_logs"!
2. После установки MySQL установить пароль на пользователя "root" (в файле создания теста из Excel /_python/myconnect.py записан пароль "123").
	Adminer по умолчанию не подключается к MySQL без пароля, для этого добавлен плагин 
	"login-password-less", временный пароль ("mypswd") хранится в файле /test/adminer/index.php.
3. Разрешить ему работу только на localhost.
4. Выполнить скрипт создания всех баз данных вместе с хранимыми процедурами - /_sql/1.test.sql.
5. Выполнить скрипт создания пользователя, от имени которого будет осуществляться тестирование и наделение его необходимыми правами - /_sql/2.test_users.sql.
6. Выполнить скрипт создания таблицы пользователей "24_group" для управления тестом - /_sql/3.24_group.sql.

***Примечание.***

В таблице представлены пользователи с паролями:
- Иванов В.Е. - 12345
- Петров Н.А. - mypass
- Сидоров В.А. - passtest

В таблицу БД "24_group" записываются md5-хеш пароли, которые можно создать на [онлайн-сервисе](https://snipp.ru/tools/md5).

	
____
[:arrow_up:Оглавление](#Оглавление)
____
## Описание базы данных
### Таблицы
База данных изначально создавалась "неправильно", т.е. без связей между таблицами, ключами и т.д. Предполагалось, что добавлением тестов будут заниматься не очень подготовленные пользователи и разработка программного интерфейса для этого не планировалось. Поэтому забота о целостности всей базы данных лежит на плечах администратора:).

#### Основная таблица "reg", в которой должны быть зарегистрированы тесты:

![Таблица reg](/_jpg/25.jpg)

Описание полей:
 - `no` int(11) NOT NULL DEFAULT '0', # номер теста
 - `desk` char(255) DEFAULT NULL,     # название теста
 - `qmax` int(11) DEFAULT NULL,       # общее кол-во вопросов в тесте (сейчас не используется)
 - `tbl` char(255) DEFAULT NULL,      # имя таблицы теста в БД
 - `autor` char(255) DEFAULT NULL,    # автор
 - `tip` int(11) DEFAULT NULL,        # вид теста, кол-во ответов (3, 4 или 5)
 - `num` int(11) DEFAULT NULL,        # кол-во выводимы вопросов теста
 - `time` int(11) DEFAULT NULL,       # время на сдачу
 - `vid` int(1) DEFAULT '0',          # 0 - тест включен (доступен), 1 - выключен

Если в поле `num` установить 0, то тест тренировочный, выводятся все вопросы, время не ограничено.

#### Таблица зарегистрированных пользователей:
![Таблица reg](/_jpg/9.jpg)

Имя таблицы __обязательно__ должно заканчиваться на "_group"!

#### Таблица "24_group" - пользователей, которые после авторизации получают доступ к системе управления:
![Таблица reg](/_jpg/26.jpg)

В отличие от обычной таблицы пользователей пароль в ней записывается в виде md5-хеша.

#### Таблица "sessions":
![Таблица reg](/_jpg/30.jpg)

В данную таблицу во время регистрации записываются сведения о пользователях, проходящих тестирование (защита от параллельной сдачи) и удаляются 
после завершения теста. Если пользователь закроет браузер до окончания тестирования, он не сможет повторно авторизоваться, пока не будет очищена 
таблица "sessions". После прохождения теста (или очисттки таблицы сессий) необходимо закрыть браузер и заново его открыть и авторизоваться, если нужно пройти другой тест.

#### Таблица вопросов теста:
![Таблица reg](/_jpg/27.jpg)
![Таблица reg](/_jpg/28.jpg)

На каждый тест создается своя таблица вопросов, например, "test1". На каждую таблицу вопросов создается таблица ответо с добавлением к имени "_a", например, "test1_a". Пользователь, от имени которого осуществляется тестирование должен иметь права "select" на поля таблицы ответов и НЕ ИМЕТЬ права "update".

#### Таблица ответов:
![Таблица reg](/_jpg/29.jpg)

### Хранимые процедуры
![Таблица reg](/_jpg/5.jpg)

____
[:arrow_up:Оглавление](#Оглавление)
____
## Управление системой тестирования

____
[:arrow_up:Оглавление](#Оглавление)
____
## Проблемные вопросы

____
[:arrow_up:Оглавление](#Оглавление)
____
## Состав дистрибутива
